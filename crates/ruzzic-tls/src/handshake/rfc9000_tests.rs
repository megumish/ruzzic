use ruzzic_common::read_bytes_to::ReadBytesTo;

use crate::handshake::Handshake;

use std::io::Cursor;

#[test]
fn server_initial_packet_client_hello() {
    env_logger::init();
    const SERVER_INITIAL_PACKET_CLIENT_HELLO: &[u8] = &[
        1, 0, 0, 237, 3, 3, 235, 248, 250, 86, 241, 41, 57, 185, 88, 74, 56, 150, 71, 46, 196, 11,
        184, 99, 207, 211, 232, 104, 4, 254, 58, 71, 240, 106, 43, 105, 72, 76, 0, 0, 4, 19, 1, 19,
        2, 1, 0, 0, 192, 0, 0, 0, 16, 0, 14, 0, 0, 11, 101, 120, 97, 109, 112, 108, 101, 46, 99,
        111, 109, 255, 1, 0, 1, 0, 0, 10, 0, 8, 0, 6, 0, 29, 0, 23, 0, 24, 0, 16, 0, 7, 0, 5, 4,
        97, 108, 112, 110, 0, 5, 0, 5, 1, 0, 0, 0, 0, 0, 51, 0, 38, 0, 36, 0, 29, 0, 32, 147, 112,
        178, 201, 202, 164, 127, 186, 186, 244, 85, 159, 237, 186, 117, 61, 225, 113, 250, 113,
        245, 15, 28, 225, 93, 67, 233, 148, 236, 116, 215, 72, 0, 43, 0, 3, 2, 3, 4, 0, 13, 0, 16,
        0, 14, 4, 3, 5, 3, 6, 3, 2, 3, 8, 4, 8, 5, 8, 6, 0, 45, 0, 2, 1, 1, 0, 28, 0, 2, 64, 1, 0,
        57, 0, 50, 4, 8, 255, 255, 255, 255, 255, 255, 255, 255, 5, 4, 128, 0, 255, 255, 7, 4, 128,
        0, 255, 255, 8, 1, 16, 1, 4, 128, 0, 117, 48, 9, 1, 16, 15, 8, 131, 148, 200, 240, 62, 81,
        87, 8, 6, 4, 128, 0, 255, 255,
    ];

    let mut input = Cursor::new(SERVER_INITIAL_PACKET_CLIENT_HELLO);
    let tls_handshake: Handshake = input.read_bytes_to().unwrap();
    eprintln!("{tls_handshake:x?}");
}
